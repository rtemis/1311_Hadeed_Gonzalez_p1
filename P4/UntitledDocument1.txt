Los datos alterados por la p√°gina o por el trigger no son visibles porque se hace el rollback antes. El deadlock se produce porque cuando se hace un sleep, la base de datos se queda esperando una respuesta de los extremos del servidor, pero como pasa suficiente tiempo, se hace un timeout y se queda esperando para siempre. Para poder evitar esto, se puede crear una condicions de excepcion que avisa si una transaccion se ha hecho timeout, y entonces se manda un aviso y se deshace la transaccion.
